{% extends "core/base.html" %}
{% block content %}
  <h2 class="page-title">
    {% if mode == "create" %}학생정보관리(추가){% else %}학생정보관리(수정){% endif %}
  </h2>

  <form method="post" class="student-form">
    {% csrf_token %}

    <div class="grid2">
      <div class="card">
        <h3 class="card-title">기본 정보</h3>
        <div class="form-row"><label>학번</label>{{ form.student_no }}</div>
        <div class="form-row"><label>이름</label>{{ form.name }}</div>
        <div class="form-row"><label>학과</label>{{ form.department }}</div>
        <div class="form-row"><label>성별</label>{{ form.gender }}</div>
      </div>

      <div class="card">
        <h3 class="card-title">과목별 성적 입력</h3>

        {{ formset.management_form }}
        <table class="tbl small">
          <thead>
            <tr><th>과목</th><th>성적(0~100)</th></tr>
          </thead>
          <tbody>
            {% for f in formset %}
              <tr>
                <td>
                  {{ f.subject_id }}
                  <input type="text" class="input" value="{{ f.initial.subject_name }}" disabled />
                </td>
                <td>{{ f.score }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>

        <p class="hint">※ 과목을 추가/삭제하면 이 입력 목록도 자동으로 반영됩니다.</p>
      </div>
    </div>

    <div style="margin-top:14px">
      <button class="btn" type="submit">저장</button>
      <a class="btn secondary" href="{% url 'home' %}">홈</a>
      {% if mode == "edit" %}
        <a class="btn secondary" href="{% url 'student_detail' student.id %}?show=1">성적 보기</a>
      {% endif %}
    </div>
  </form>
{% endblock %}
